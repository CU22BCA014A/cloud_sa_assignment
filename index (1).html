<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Sensor Data Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <style>
        :root {
            --color-bg-primary: #fcfcf9;
            --color-surface: #fffffd;
            --color-text-primary: #13343b;
            --color-text-secondary: #626c71;
            --color-primary: #218085;
            --color-primary-hover: #1d7480;
            --color-border: rgba(94, 82, 64, 0.2);
            --color-success: #218085;
            --color-warning: #e68161;
            --color-card-border: rgba(94, 82, 64, 0.12);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --color-bg-primary: #1f2121;
                --color-surface: #262828;
                --color-text-primary: #f5f5f5;
                --color-text-secondary: rgba(167, 169, 169, 0.7);
                --color-primary: #32b8c6;
                --color-primary-hover: #2da6b2;
                --color-border: rgba(119, 124, 124, 0.3);
                --color-card-border: rgba(119, 124, 124, 0.2);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--color-bg-primary);
            color: var(--color-text-primary);
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 32px;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--color-text-primary);
        }

        .subtitle {
            color: var(--color-text-secondary);
            font-size: 16px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow-md);
        }

        .stat-label {
            font-size: 14px;
            color: var(--color-text-secondary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .stat-value {
            font-size: 36px;
            font-weight: 600;
            color: var(--color-text-primary);
            margin-bottom: 4px;
        }

        .stat-unit {
            font-size: 16px;
            color: var(--color-text-secondary);
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
            font-size: 14px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--color-success);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .chart-container {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow-md);
            margin-bottom: 30px;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 20px;
            font-weight: 600;
        }

        .controls {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 8px;
            border: 1px solid var(--color-border);
            background: var(--color-surface);
            color: var(--color-text-primary);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .btn:hover {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .btn.active {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .simulator-panel {
            background: var(--color-surface);
            border: 1px solid var(--color-card-border);
            border-radius: 12px;
            padding: 24px;
            box-shadow: var(--shadow-md);
        }

        .simulator-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .simulator-controls {
            display: flex;
            gap: 12px;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
            border: none;
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
        }

        .btn-danger {
            background: #ff5459;
            color: white;
            border: none;
        }

        .btn-danger:hover {
            background: #e64850;
        }

        .log-container {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            padding: 16px;
            max-height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }

        .log-entry {
            padding: 4px 0;
            border-bottom: 1px solid var(--color-border);
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        .timestamp {
            color: var(--color-text-secondary);
            margin-right: 8px;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid var(--color-border);
            color: var(--color-text-secondary);
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üå°Ô∏è IoT Sensor Data Dashboard</h1>
            <p class="subtitle">Real-time Temperature &amp; Humidity Monitoring System</p>
        </header>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Current Temperature</div>
                <div class="stat-value" id="currentTemp">--</div>
                <div class="stat-unit">¬∞C</div>
                <div class="status-indicator">
                    <span class="status-dot"></span>
                    <span>Live</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Current Humidity</div>
                <div class="stat-value" id="currentHumidity">--</div>
                <div class="stat-unit">%</div>
                <div class="status-indicator">
                    <span class="status-dot"></span>
                    <span>Live</span>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Average Temperature</div>
                <div class="stat-value" id="avgTemp">--</div>
                <div class="stat-unit">¬∞C</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Total Data Points</div>
                <div class="stat-value" id="dataCount">0</div>
                <div class="stat-unit">readings</div>
            </div>
        </div>

        <div class="chart-container">
            <div class="chart-header">
                <h2 class="chart-title">Sensor Data Trends</h2>
                <div class="controls">
                    <button class="btn active" data-range="10">Last 10</button>
                    <button class="btn" data-range="50">Last 50</button>
                    <button class="btn" data-range="100">Last 100</button>
                </div>
            </div>
            <canvas id="sensorChart"></canvas>
        </div>

        <div class="simulator-panel">
            <div class="simulator-header">
                <h2 class="chart-title">IoT Sensor Simulator</h2>
                <div class="simulator-controls">
                    <button class="btn btn-primary" id="startSimulator">Start Simulation</button>
                    <button class="btn btn-danger" id="stopSimulator" disabled>Stop Simulation</button>
                    <button class="btn" id="clearData">Clear All Data</button>
                </div>
            </div>
            <div class="log-container" id="logContainer">
                <div class="log-entry">
                    <span class="timestamp">[Ready]</span>
                    <span>IoT sensor simulator ready. Click "Start Simulation" to begin...</span>
                </div>
            </div>
        </div>

        <footer class="footer">
            <p>Cloud-Based IoT Data Management &amp; Visualization | CU22BCA014A - Nikhil N M</p>
        </footer>
    </div>

    <script>
        // Configuration
        const CONFIG = {
            dataLimit: 100,
            updateInterval: 5000,
            tempRange: { min: 20, max: 30 },
            humidityRange: { min: 30, max: 50 }
        };

        // State management
        let sensorData = [];
        let simulatorInterval = null;
        let displayRange = 10;

        // Chart setup
        const ctx = document.getElementById('sensorChart').getContext('2d');
        const sensorChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [
                    {
                        label: 'Temperature (¬∞C)',
                        borderColor: 'rgb(255, 99, 132)',
                        backgroundColor: 'rgba(255, 99, 132, 0.1)',
                        data: [],
                        tension: 0.4,
                        fill: true,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    },
                    {
                        label: 'Humidity (%)',
                        borderColor: 'rgb(54, 162, 235)',
                        backgroundColor: 'rgba(54, 162, 235, 0.1)',
                        data: [],
                        tension: 0.4,
                        fill: true,
                        pointRadius: 4,
                        pointHoverRadius: 6
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                aspectRatio: 2.5,
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                scales: {
                    x: {
                        display: true,
                        title: {
                            display: true,
                            text: 'Time'
                        }
                    },
                    y: {
                        display: true,
                        title: {
                            display: true,
                            text: 'Value'
                        },
                        beginAtZero: true
                    }
                }
            }
        });

        // Generate random sensor data
        function generateSensorData() {
            const temp = Math.round((Math.random() * (CONFIG.tempRange.max - CONFIG.tempRange.min) + CONFIG.tempRange.min) * 100) / 100;
            const humidity = Math.round((Math.random() * (CONFIG.humidityRange.max - CONFIG.humidityRange.min) + CONFIG.humidityRange.min) * 100) / 100;
            const timestamp = new Date();

            return {
                temperature: temp,
                humidity: humidity,
                timestamp: timestamp
            };
        }

        // Add log entry
        function addLog(message, type = 'info') {
            const logContainer = document.getElementById('logContainer');
            const timestamp = new Date().toLocaleTimeString();
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.innerHTML = `<span class="timestamp">[${timestamp}]</span><span>${message}</span>`;
            logContainer.appendChild(entry);
            logContainer.scrollTop = logContainer.scrollHeight;

            // Keep only last 20 log entries
            while (logContainer.children.length > 20) {
                logContainer.removeChild(logContainer.firstChild);
            }
        }

        // Save data
        function saveSensorData(data) {
            sensorData.push(data);
            
            // Keep only last CONFIG.dataLimit entries
            if (sensorData.length > CONFIG.dataLimit) {
                sensorData.shift();
            }

            // Store in memory (no localStorage in sandbox)
            addLog(`Data saved: Temp ${data.temperature}¬∞C, Humidity ${data.humidity}%`);
            updateDashboard();
        }

        // Update dashboard
        function updateDashboard() {
            if (sensorData.length === 0) return;

            // Update current values
            const latest = sensorData[sensorData.length - 1];
            document.getElementById('currentTemp').textContent = latest.temperature.toFixed(2);
            document.getElementById('currentHumidity').textContent = latest.humidity.toFixed(2);

            // Calculate average temperature
            const avgTemp = sensorData.reduce((sum, d) => sum + d.temperature, 0) / sensorData.length;
            document.getElementById('avgTemp').textContent = avgTemp.toFixed(2);

            // Update data count
            document.getElementById('dataCount').textContent = sensorData.length;

            // Update chart
            updateChart();
        }

        // Update chart
        function updateChart() {
            const dataToShow = sensorData.slice(-displayRange);

            sensorChart.data.labels = dataToShow.map(d => 
                d.timestamp.toLocaleTimeString()
            );
            sensorChart.data.datasets[0].data = dataToShow.map(d => d.temperature);
            sensorChart.data.datasets[1].data = dataToShow.map(d => d.humidity);

            sensorChart.update();
        }

        // Start simulator
        function startSimulator() {
            if (simulatorInterval) return;

            document.getElementById('startSimulator').disabled = true;
            document.getElementById('stopSimulator').disabled = false;
            addLog('‚úÖ Simulator started - generating data every 5 seconds');

            // Generate initial data
            const initialData = generateSensorData();
            saveSensorData(initialData);

            simulatorInterval = setInterval(() => {
                const data = generateSensorData();
                saveSensorData(data);
            }, CONFIG.updateInterval);
        }

        // Stop simulator
        function stopSimulator() {
            if (!simulatorInterval) return;

            clearInterval(simulatorInterval);
            simulatorInterval = null;

            document.getElementById('startSimulator').disabled = false;
            document.getElementById('stopSimulator').disabled = true;
            addLog('‚è∏Ô∏è Simulator stopped');
        }

        // Clear all data
        function clearAllData() {
            if (confirm('Are you sure you want to clear all sensor data?')) {
                sensorData = [];
                updateDashboard();
                sensorChart.data.labels = [];
                sensorChart.data.datasets[0].data = [];
                sensorChart.data.datasets[1].data = [];
                sensorChart.update();
                
                document.getElementById('currentTemp').textContent = '--';
                document.getElementById('currentHumidity').textContent = '--';
                document.getElementById('avgTemp').textContent = '--';
                document.getElementById('dataCount').textContent = '0';
                
                addLog('üóëÔ∏è All data cleared');
            }
        }

        // Event listeners
        document.getElementById('startSimulator').addEventListener('click', startSimulator);
        document.getElementById('stopSimulator').addEventListener('click', stopSimulator);
        document.getElementById('clearData').addEventListener('click', clearAllData);

        // Range selector buttons
        document.querySelectorAll('.btn[data-range]').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.btn[data-range]').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                displayRange = parseInt(this.dataset.range);
                updateChart();
            });
        });

        // Initialize
        addLog('üöÄ Dashboard initialized and ready');
    </script>
</body>
</html>
